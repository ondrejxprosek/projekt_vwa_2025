<!-- COMMENTS: shift+option+A or whole line shift+cmd+ú in jinja {# whatever #} -->
<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>{{ title or 'Moje Aplikace' }}</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body>
<header class="navbar container">
    <a class="home-link" href="{{ url_for('index') }}" title="Domů">
      <img src="{{ url_for('static', filename='img/home.png') }}" alt="Domů" width="22" height="22" aria-hidden="true">
    </a>
    <a class="home-link" href="{{ url_for('cashier') }}" title="Pokladna">
      <img src="{{ url_for('static', filename='img/cashier.png') }}" alt="Pokladna" width="22" height="22" aria-hidden="true">
    </a>
<div class="brand">
<span class="badge">MOJE APLIKACE</span>
</div>
<div class="nav-actions">
{% if session.get('user_id') %}
<div class="kv">{{ current_user.username }} • <span class="small-muted">{{ current_user.role }}</span></div>
{% if perms.can_manage_users %}<a class="btn" href="{{ url_for('admin_panel') }}">Uživatelé</a>{% endif %}
{% if perms.can_manage_users %}<a class="btn" href="{{ url_for('admin_permissions') }}">Role a práva</a>{% endif %}
{% if perms.can_manage_tables %}<a class="btn" href="{{ url_for('tables') }}">Stoly</a>{% endif %}
{% if perms.can_manage_items %}<a class="btn" href="{{ url_for('admin_items') }}">Položky</a>{% endif %}
{% if perms.can_view_closed_orders %}<a class="btn" href="{{ url_for('closed_orders') }}">Uzavřené účty</a>{% endif %}
<a class="btn" href="{{ url_for('logout') }}">Odhlásit</a>
{% else %}
<a class="btn" href="{{ url_for('login') }}">Přihlásit</a>
<a class="btn" href="{{ url_for('register') }}">Registrovat</a>
{% endif %}
</div>
</header>


<main class="container">
{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}
{% for category, msg in messages %}
<div class="flash flash-{{ 'success' if category=='success' else ('danger' if category=='danger' else 'info') }} card">
{{ msg }}
</div>
{% endfor %}
{% endif %}
{% endwith %}


{% block content %}{% endblock %}

{% if current_user %}
<div style="background:rgba(255,0,0,0.1);padding:10px;margin:10px;font-size:12px;">
  <strong>DEBUG:</strong> Role: {{ current_user.role }}<br>
  can_cashier: {{ perms.can_cashier }}<br>
  can_manage_tables: {{ perms.can_manage_tables }}<br>
  can_manage_items: {{ perms.can_manage_items }}<br>
  can_view_closed_orders: {{ perms.can_view_closed_orders }}<br>
  can_manage_users: {{ perms.can_manage_users }}
</div>
{% endif %}

<div class="footer">© {{ 2025 }} • ITB Vision s.r.o.</div>
</main>


</body>
</html>