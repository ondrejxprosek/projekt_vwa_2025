{% extends 'base.html' %}
{% block content %}
<div style="display:flex;align-items:center;justify-content:center;min-height:60vh;">
  <div class="card" style="max-width:500px;width:100%;">
    
    <!-- Hlavička -->
    <div style="text-align:center;margin-bottom:20px;border-bottom:2px solid rgba(124,92,255,0.2);padding-bottom:16px;">
      <h2 style="margin:0;font-size:24px;">ÚČTENKA</h2>
      <div style="margin-top:8px;font-size:16px;font-weight:700;">{{ order.table.name }}</div>
      <div class="small-muted" style="margin-top:4px;">Účet #{{ order.id }}</div>
      <div class="small-muted" style="margin-top:2px;">{{ order.opened_at.strftime('%d.%m.%Y %H:%M:%S') }}</div>
    </div>

    <!-- Soupis položek -->
    <div style="margin-bottom:16px;">
      {% if items %}
        {% set ns = namespace(total=0) %}
        {% for item in items %}
        <div style="display:flex;justify-content:space-between;margin-bottom:8px;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.02);">
          <div>
            <div style="font-weight:600;">{{ item.item.name }}{% if item.quantity > 1 %} ×{{ item.quantity }}{% endif %}</div>
            <div class="small-muted" style="font-size:12px;">{{ item.timestamp.strftime('%H:%M:%S') }}</div>
          </div>
          <div style="font-weight:700;text-align:right;">{{ "%.2f"|format(item.price * item.quantity) }} Kč</div>
        </div>
        {% set ns.total = ns.total + (item.price * item.quantity) %}
        {% endfor %}
      {% else %}
        <p class="hint">Žádné položky.</p>
      {% endif %}
    </div>

    <!-- Součet -->
    <div style="display:flex;justify-content:space-between;align-items:center;padding:14px;background:linear-gradient(90deg, rgba(124,92,255,0.1), rgba(0,230,168,0.1));border-radius:10px;margin-bottom:16px;font-weight:700;font-size:18px;">
      <div>CELKEM</div>
      <div style="color:var(--accent);">{{ "%.2f"|format(ns.total) }} Kč</div>
    </div>

    <!-- Tlačítka -->
    <div style="display:flex;gap:8px;">
      <form method="POST" action="{{ url_for('cashier_pay', order_id=order.id) }}" style="flex:1;" target="_blank">
        <button class="btn glow" type="submit" style="width:100%;padding:12px;font-weight:700;">Zaplatit</button>
      </form>
      <a class="btn" href="{{ url_for('cashier_order', order_id=order.id) }}" style="flex:1;text-align:center;padding:12px;">Zpět</a>
    </div>
  </div>
</div>
{% endblock %}